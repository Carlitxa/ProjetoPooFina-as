<!DOCTYPE html>
<html>
<head>
    <title>RelatÃ³rios</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- NAVBAR -->
<div class="navbar">
    <h2>Sistema Financeiro</h2>
    <span class="dark-toggle" onclick="toggleDark()">ðŸŒ™</span>
</div>

<!-- CONTEÃšDO -->
<div class="page">
  <div class="card">

    <h2>ðŸ“ˆ RelatÃ³rios Financeiros</h2>
    <br>

    <p>
        <strong>Total de Receitas:</strong>
        <span class="valor-positivo">{{ total_r }} â‚¬</span>
    </p>

    <p>
        <strong>Total de Despesas:</strong>
        <span class="valor-negativo">{{ total_d }} â‚¬</span>
    </p>

    <p>
        <strong>Saldo Atual:</strong> {{ saldo }} â‚¬
    </p>

    <hr><br>

    <!-- DADOS PASSADOS DE FORMA SEGURA -->
    <canvas
        id="despesasChart"
        data-labels='{{ labels | tojson }}'
        data-values='{{ values | tojson }}'>
    </canvas>

    <br>
    <a href="/dashboard" class="btn btn-secondary">â¬… Voltar ao Painel</a>

  </div>
</div>

<script>
function toggleDark(){
    document.body.classList.toggle("dark");
    localStorage.setItem(
        "darkMode",
        document.body.classList.contains("dark") ? "on" : "off"
    );
}

window.onload = function(){
    if(localStorage.getItem("darkMode") === "on"){
        document.body.classList.add("dark");
    }

    const canvas = document.getElementById("despesasChart");
    const labels = JSON.parse(canvas.dataset.labels);
    const values = JSON.parse(canvas.dataset.values);

    new Chart(canvas, {
        type: "bar",
        data: {
            labels: labels,
            datasets: [{
                label: "Despesas (â‚¬)",
                data: values,
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
};
</script>

</body>
</html>
